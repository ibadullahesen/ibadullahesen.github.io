<!DOCTYPE html>
<html lang="az">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="AxtarGet - Professional Image Editor. Powerful photo editing tools: filters, background removal, adjustments, and more. Free online image editor like Photoshop.">
    <meta name="keywords" content="image editor, photo editor, background remover, filters, online editor, AxtarGet, professional editing">
    <meta name="author" content="AxtarGet">
    <meta property="og:title" content="AxtarGet - Professional Image Editor">
    <meta property="og:description" content="Powerful image editing tools - Background removal, filters, tone adjustments, and professional effects">
    <meta property="og:image" content="https://axtarget.xyz/og-image.jpg">
    <meta name="theme-color" content="#0F172A">
    <title>AxtarGet - Professional Image Editor | Free Online Photo Editing</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-dark: #0F172A;
            --bg-card: #1E293B;
            --bg-panel: #334155;
            --bg-hover: #475569;
            --border-color: #1E293B;
            --text-primary: #F1F5F9;
            --text-secondary: #CBD5E1;
            --accent-primary: #3B82F6;
            --accent-hover: #2563EB;
            --accent-active: #1D4ED8;
            --success: #10B981;
            --danger: #EF4444;
            --warning: #F59E0B;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background-color: var(--bg-dark);
            color: var(--text-primary);
            line-height: 1.5;
            overflow: hidden;
        }

        .app-container {
            display: flex;
            height: 100vh;
            flex-direction: column;
        }

        /* HEADER */
        header {
            background-color: var(--bg-card);
            border-bottom: 1px solid var(--border-color);
            padding: 0.75rem 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 100;
        }

        .header-brand {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--accent-primary);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .header-actions {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .file-name {
            color: var(--text-secondary);
            font-size: 0.875rem;
            max-width: 200px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        /* MAIN EDITOR AREA */
        .editor-container {
            display: flex;
            flex: 1;
            overflow: hidden;
            gap: 1px;
            background-color: var(--border-color);
        }

        /* LEFT TOOLBAR */
        .toolbar-left {
            width: 70px;
            background-color: var(--bg-card);
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 1rem 0;
            gap: 0.5rem;
            border-right: 1px solid var(--border-color);
            overflow-y: auto;
        }

        .tool-btn {
            width: 50px;
            height: 50px;
            border-radius: 0.5rem;
            background-color: transparent;
            color: var(--text-secondary);
            border: 2px solid transparent;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            transition: all 0.2s ease;
            position: relative;
        }

        .tool-btn:hover {
            background-color: var(--bg-panel);
            color: var(--text-primary);
        }

        .tool-btn.active {
            background-color: var(--accent-primary);
            color: white;
            border-color: var(--accent-primary);
        }

        .tool-btn svg {
            width: 24px;
            height: 24px;
        }

        /* CENTER CANVAS */
        .canvas-wrapper {
            flex: 1;
            display: flex;
            flex-direction: column;
            background-color: var(--bg-dark);
            position: relative;
            overflow: hidden;
        }

        .canvas-area {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(45deg, #1E293B 25%, transparent 25%, transparent 75%, #1E293B 75%, #1E293B),
                        linear-gradient(45deg, #1E293B 25%, transparent 25%, transparent 75%, #1E293B 75%, #1E293B);
            background-size: 20px 20px;
            background-position: 0 0, 10px 10px;
            background-color: var(--bg-dark);
            position: relative;
            overflow: hidden;
        }

        canvas {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            cursor: crosshair;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .empty-state {
            text-align: center;
            color: var(--text-secondary);
            padding: 2rem;
        }

        .empty-state-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        .empty-state-text {
            font-size: 1rem;
            margin-bottom: 1.5rem;
        }

        .upload-zone {
            position: absolute;
            inset: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: rgba(0, 0, 0, 0.5);
            border: 2px dashed var(--accent-primary);
            border-radius: 0.5rem;
            cursor: pointer;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.2s ease;
            z-index: 10;
        }

        .upload-zone.active {
            opacity: 1;
            pointer-events: all;
        }

        /* RIGHT PANEL */
        .panel-right {
            width: 320px;
            background-color: var(--bg-card);
            border-left: 1px solid var(--border-color);
            overflow-y: auto;
            padding: 1rem;
            display: flex;
            flex-direction: column;
        }

        .panel-section {
            margin-bottom: 1.5rem;
        }

        .panel-title {
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 0.75rem;
        }

        /* SLIDERS */
        .slider-group {
            margin-bottom: 1.25rem;
        }

        .slider-label {
            display: flex;
            justify-content: space-between;
            font-size: 0.875rem;
            margin-bottom: 0.5rem;
            color: var(--text-secondary);
        }

        .slider-label-value {
            color: var(--accent-primary);
            font-weight: 600;
        }

        input[type="range"] {
            width: 100%;
            height: 4px;
            border-radius: 2px;
            background: var(--bg-panel);
            outline: none;
            -webkit-appearance: none;
            appearance: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: var(--accent-primary);
            cursor: pointer;
            transition: background 0.2s ease;
        }

        input[type="range"]::-webkit-slider-thumb:hover {
            background: var(--accent-hover);
        }

        input[type="range"]::-moz-range-thumb {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: var(--accent-primary);
            cursor: pointer;
            border: none;
            transition: background 0.2s ease;
        }

        input[type="range"]::-moz-range-thumb:hover {
            background: var(--accent-hover);
        }

        /* BUTTONS */
        .btn {
            padding: 0.5rem 1rem;
            border-radius: 0.375rem;
            border: none;
            font-size: 0.875rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            white-space: nowrap;
        }

        .btn-primary {
            background-color: var(--accent-primary);
            color: white;
            width: 100%;
        }

        .btn-primary:hover {
            background-color: var(--accent-hover);
        }

        .btn-primary:active {
            background-color: var(--accent-active);
        }

        .btn-secondary {
            background-color: var(--bg-panel);
            color: var(--text-primary);
        }

        .btn-secondary:hover {
            background-color: var(--bg-hover);
        }

        .btn-small {
            padding: 0.375rem 0.75rem;
            font-size: 0.75rem;
        }

        .btn-group {
            display: flex;
            gap: 0.5rem;
            width: 100%;
        }

        .btn-group .btn {
            flex: 1;
        }

        .btn.active {
            background-color: var(--accent-primary);
            color: white;
        }

        /* FILTER SELECTOR */
        .filter-selector {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .filter-option {
            background-color: var(--bg-panel);
            border: 2px solid transparent;
            color: var(--text-secondary);
            padding: 0.75rem;
            border-radius: 0.375rem;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.875rem;
            text-align: left;
        }

        .filter-option:hover {
            background-color: var(--bg-hover);
            color: var(--text-primary);
        }

        .filter-option.active {
            background-color: var(--accent-primary);
            color: white;
            border-color: var(--accent-primary);
        }

        /* HIDDEN ELEMENTS */
        input[type="file"] {
            display: none;
        }

        .hidden {
            display: none !important;
        }

        /* TOAST NOTIFICATION */
        .toast {
            position: fixed;
            bottom: 1.5rem;
            right: 1.5rem;
            background-color: var(--bg-card);
            color: var(--text-primary);
            padding: 1rem 1.5rem;
            border-radius: 0.5rem;
            border-left: 4px solid var(--success);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            z-index: 200;
            animation: slideIn 0.3s ease;
            max-width: 300px;
        }

        .toast.error {
            border-left-color: var(--danger);
        }

        .toast.warning {
            border-left-color: var(--warning);
        }

        @keyframes slideIn {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        /* TEXT TOOL MODAL */
        .text-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .text-modal-content {
            background-color: var(--bg-card);
            border-radius: 0.5rem;
            padding: 1.5rem;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);
        }

        .text-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .text-modal-title {
            font-size: 1.25rem;
            font-weight: 600;
        }

        .text-modal-close {
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 0.25rem;
        }

        .text-modal-close:hover {
            background-color: var(--bg-hover);
        }

        .text-input-group {
            margin-bottom: 1rem;
        }

        .text-input-group label {
            display: block;
            margin-bottom: 0.5rem;
            color: var(--text-secondary);
            font-size: 0.875rem;
        }

        .text-input {
            width: 100%;
            padding: 0.75rem;
            border-radius: 0.375rem;
            border: 1px solid var(--border-color);
            background-color: var(--bg-panel);
            color: var(--text-primary);
            font-size: 1rem;
        }

        .text-input:focus {
            outline: none;
            border-color: var(--accent-primary);
        }

        .text-preview {
            background-color: var(--bg-panel);
            border-radius: 0.375rem;
            padding: 1rem;
            margin-bottom: 1rem;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid var(--border-color);
        }

        /* RESPONSIVE */
        @media (max-width: 1024px) {
            .panel-right {
                width: 280px;
            }
        }

        @media (max-width: 768px) {
            .panel-right {
                display: none;
            }

            .toolbar-left {
                width: 60px;
            }

            .tool-btn {
                width: 45px;
                height: 45px;
                font-size: 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- HEADER -->
        <header>
            <div class="header-brand">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="3" width="18" height="18" rx="2"/>
                    <circle cx="8" cy="8" r="1.5"/>
                    <path d="M3 14L8 9L14 15L21 8V21"/>
                </svg>
                AxtarGet
            </div>
            <div class="file-name" id="fileName">≈û…ôkil se√ßin</div>
            <div class="header-actions">
                <button class="btn btn-secondary btn-small" id="resetBtn" disabled>
                    <span>‚Üª</span> Sƒ±fƒ±rla
                </button>
                <button class="btn btn-primary btn-small" id="downloadBtn" disabled>
                    ‚¨á Endir
                </button>
            </div>
        </header>

        <!-- MAIN EDITOR -->
        <div class="editor-container">
            <!-- LEFT TOOLBAR -->
            <div class="toolbar-left">
                <button class="tool-btn active" id="toolSelect" title="Se√ßim">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path d="M3 3v18h18V3H3zm2 2h14v14H5V5z"/>
                    </svg>
                </button>
                <button class="tool-btn" id="toolFilters" title="Filtrl…ôri">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path d="M5 13H2v8h3v-8zm15 0h-3v8h3v-8zm-6-11H8v19h6V2z"/>
                    </svg>
                </button>
                <button class="tool-btn" id="toolAdjust" title="D√ºz…ôli≈ül…ôr">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <circle cx="12" cy="12" r="1"/><circle cx="12" cy="5" r="1"/><circle cx="12" cy="19" r="1"/>
                        <path d="M12 8v-3M12 11v-1M12 13v1M12 15v3" stroke="currentColor" stroke-width="2" fill="none"/>
                    </svg>
                </button>
                <button class="tool-btn" id="toolRemove" title="Fon Silm…ô">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path d="M3 6h18M5 6L7 3h10l2 3M6 9v10c0 1-1 2-2 2H4c-1 0-2-1-2-2V9M18 9v10c0 1 1 2 2 2h2c1 0 2-1 2-2V9M10 12v6M14 12v6"/>
                    </svg>
                </button>
                <button class="tool-btn" id="toolBrush" title="Fƒ±r√ßa">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path d="M20.71 7.71L12 16.41 6.7 21.71c-.39.39-1.02.39-1.41 0l-5-5c-.39-.39-.39-1.02 0-1.41L10.59 3.29c.39-.39 1.02-.39 1.41 0l9-9c.39-.39 1.02-.39 1.41 0l5 5c.39.39.39 1.02 0 1.41z"/>
                    </svg>
                </button>
                <button class="tool-btn" id="toolText" title="M…ôtn ∆èlav…ô Et">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path d="M4 6h16M4 12h16M4 18h7" stroke="currentColor" stroke-width="2" fill="none"/>
                    </svg>
                </button>
            </div>

            <!-- CANVAS AREA -->
            <div class="canvas-wrapper">
                <div class="canvas-area" id="canvasArea">
                    <div class="upload-zone" id="uploadZone">
                        <div class="empty-state">
                            <div class="empty-state-icon">üìÅ</div>
                            <div class="empty-state-text">≈û…ôkili buraya s√ºr√ºkl…ô</div>
                        </div>
                    </div>
                    <div class="empty-state" id="emptyState">
                        <div class="empty-state-icon">üñºÔ∏è</div>
                        <div class="empty-state-text">≈û…ôkil y√ºkl…ôm…ôk √º√ß√ºn a≈üaƒüƒ± d√ºym…ôni klikl…ôyin</div>
                        <label for="fileInput" class="btn btn-primary" style="cursor: pointer;">
                            üì§ ≈û…ôkil Y√ºkl…ô
                        </label>
                    </div>
                    <canvas id="canvas" class="hidden"></canvas>
                </div>
            </div>

            <!-- RIGHT PANEL -->
            <div class="panel-right" id="controlPanel">
                <!-- FILTERS -->
                <div id="filtersSection">
                    <div class="panel-title">Filtrl…ôri</div>
                    <div class="filter-selector">
                        <button class="filter-option active" data-filter="none">Orijinal</button>
                        <button class="filter-option" data-filter="grayscale">Qara-Aƒü</button>
                        <button class="filter-option" data-filter="sepia">Sepia Tonu</button>
                        <button class="filter-option" data-filter="vintage">K√∂hn…ô Film</button>
                        <button class="filter-option" data-filter="warm">ƒ∞sti Ton</button>
                        <button class="filter-option" data-filter="cool">Soyuq Ton</button>
                        <button class="filter-option" data-filter="vibrant">Canlƒ±</button>
                        <button class="filter-option" data-filter="dramatic">Dramatik</button>
                    </div>
                </div>

                <!-- ADJUSTMENTS -->
                <div id="adjustmentsSection" class="panel-section">
                    <div class="panel-title">D√ºz…ôli≈ül…ôr</div>
                    
                    <div class="slider-group">
                        <div class="slider-label">
                            <span>Parlaqlƒ±q</span>
                            <span class="slider-label-value" id="brightnessValue">0</span>
                        </div>
                        <input type="range" id="brightness" min="-100" max="100" value="0">
                    </div>

                    <div class="slider-group">
                        <div class="slider-label">
                            <span>Kontrast</span>
                            <span class="slider-label-value" id="contrastValue">0</span>
                        </div>
                        <input type="range" id="contrast" min="-100" max="100" value="0">
                    </div>

                    <div class="slider-group">
                        <div class="slider-label">
                            <span>Doyƒüunluq</span>
                            <span class="slider-label-value" id="saturationValue">0</span>
                        </div>
                        <input type="range" id="saturation" min="-100" max="100" value="0">
                    </div>

                    <div class="slider-group">
                        <div class="slider-label">
                            <span>Ton</span>
                            <span class="slider-label-value" id="hueValue">0</span>
                        </div>
                        <input type="range" id="hue" min="-180" max="180" value="0">
                    </div>

                    <div class="slider-group">
                        <div class="slider-label">
                            <span>Bulanƒ±qlƒ±q</span>
                            <span class="slider-label-value" id="blurValue">0</span>
                        </div>
                        <input type="range" id="blur" min="0" max="20" value="0">
                    </div>
                </div>

                <!-- BACKGROUND REMOVAL -->
                <div id="bgRemovalSection" class="panel-section hidden">
                    <div class="panel-title">Fon Silm…ô</div>
                    
                    <div class="btn-group">
                        <button class="btn btn-secondary active" id="colorRemoveMode">R…ông…ô G√∂r…ô</button>
                        <button class="btn btn-secondary" id="brushRemoveMode">Fƒ±r√ßa</button>
                    </div>

                    <div id="colorPickerSection" class="panel-section">
                        <label style="color: var(--text-secondary); font-size: 0.875rem; display: block; margin-bottom: 0.5rem;">
                            Silin…ôc…ôk R…ông:
                        </label>
                        <input type="color" id="colorToRemove" value="#00ff00" style="width: 100%; height: 40px; border: 1px solid var(--border-color); border-radius: 0.375rem; cursor: pointer;">
                        
                        <div class="slider-group">
                            <div class="slider-label">
                                <span>Tolerans</span>
                                <span class="slider-label-value" id="toleranceValue">30</span>
                            </div>
                            <input type="range" id="tolerance" min="0" max="100" value="30">
                        </div>

                        <button class="btn btn-primary" id="applyColorRemove">T…ôtbiq Et</button>
                    </div>

                    <div id="brushSection" class="panel-section hidden">
                        <div class="slider-group">
                            <div class="slider-label">
                                <span>Fƒ±r√ßa √ñl√ß√ºs√º</span>
                                <span class="slider-label-value" id="brushSizeValue">20</span>
                            </div>
                            <input type="range" id="brushSize" min="5" max="100" value="20">
                        </div>
                    </div>
                </div>

                <!-- TEXT TOOL -->
                <div id="textSection" class="panel-section hidden">
                    <div class="panel-title">M…ôtn ∆èlav…ô Et</div>
                    <button class="btn btn-primary" id="addTextBtn">M…ôtn ∆èlav…ô Et</button>
                </div>

                <!-- EXPORT OPTIONS -->
                <div class="panel-section">
                    <div class="panel-title">Keyfiyy…ôt</div>
                    <div class="btn-group">
                        <button class="btn btn-secondary active" data-quality="1">T…ômiz</button>
                        <button class="btn btn-secondary" data-quality="0.8">80%</button>
                        <button class="btn btn-secondary" data-quality="0.6">60%</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- TEXT MODAL -->
    <div id="textModal" class="text-modal hidden">
        <div class="text-modal-content">
            <div class="text-modal-header">
                <div class="text-modal-title">M…ôtn ∆èlav…ô Et</div>
                <button class="text-modal-close" id="textModalClose">&times;</button>
            </div>
            <div class="text-input-group">
                <label for="textInput">M…ôtn:</label>
                <input type="text" id="textInput" class="text-input" placeholder="M…ôtninizi yazƒ±n...">
            </div>
            <div class="text-input-group">
                <label for="textColor">R…ông:</label>
                <input type="color" id="textColor" value="#ffffff" style="width: 100%; height: 40px; border: 1px solid var(--border-color); border-radius: 0.375rem; cursor: pointer;">
            </div>
            <div class="text-input-group">
                <label for="textSize">√ñl√ß√º:</label>
                <input type="range" id="textSize" min="12" max="72" value="24">
                <div class="slider-label">
                    <span></span>
                    <span class="slider-label-value" id="textSizeValue">24px</span>
                </div>
            </div>
            <div class="text-preview" id="textPreview">
                <span id="previewText" style="font-size: 24px; color: white;">M…ôtn √ñnizl…ôm…ô</span>
            </div>
            <div class="btn-group">
                <button class="btn btn-secondary" id="cancelTextBtn">L…ôƒüv Et</button>
                <button class="btn btn-primary" id="applyTextBtn">T…ôtbiq Et</button>
            </div>
        </div>
    </div>

    <!-- HIDDEN ELEMENTS -->
    <input type="file" id="fileInput" accept="image/*">

    <script>
        // IMAGE EDITOR STATE
        const state = {
            originalImage: null,
            canvas: document.getElementById('canvas'),
            ctx: null,
            currentFilter: 'none',
            adjustments: {
                brightness: 0,
                contrast: 0,
                saturation: 0,
                hue: 0,
                blur: 0
            },
            quality: 1,
            history: [],
            isDrawing: false,
            currentTool: 'select',
            bgRemovalMode: 'color',
            textElements: [],
            activeTextElement: null,
            isDraggingText: false,
            dragOffset: { x: 0, y: 0 }
        };

        state.ctx = state.canvas.getContext('2d', { willReadFrequently: true });

        // ELEMENTS
        const elements = {
            fileInput: document.getElementById('fileInput'),
            canvas: state.canvas,
            canvasArea: document.getElementById('canvasArea'),
            emptyState: document.getElementById('emptyState'),
            uploadZone: document.getElementById('uploadZone'),
            fileName: document.getElementById('fileName'),
            downloadBtn: document.getElementById('downloadBtn'),
            resetBtn: document.getElementById('resetBtn'),
            controlPanel: document.getElementById('controlPanel'),
            
            // Tools
            toolSelect: document.getElementById('toolSelect'),
            toolFilters: document.getElementById('toolFilters'),
            toolAdjust: document.getElementById('toolAdjust'),
            toolRemove: document.getElementById('toolRemove'),
            toolBrush: document.getElementById('toolBrush'),
            toolText: document.getElementById('toolText'),

            // Filter buttons
            filterButtons: document.querySelectorAll('.filter-option'),

            // Adjustment sliders
            brightness: document.getElementById('brightness'),
            contrast: document.getElementById('contrast'),
            saturation: document.getElementById('saturation'),
            hue: document.getElementById('hue'),
            blur: document.getElementById('blur'),

            // Slider value displays
            brightnessValue: document.getElementById('brightnessValue'),
            contrastValue: document.getElementById('contrastValue'),
            saturationValue: document.getElementById('saturationValue'),
            hueValue: document.getElementById('hueValue'),
            blurValue: document.getElementById('blurValue'),

            // Sections
            filtersSection: document.getElementById('filtersSection'),
            adjustmentsSection: document.getElementById('adjustmentsSection'),
            bgRemovalSection: document.getElementById('bgRemovalSection'),
            textSection: document.getElementById('textSection'),

            // Background removal
            colorRemoveMode: document.getElementById('colorRemoveMode'),
            brushRemoveMode: document.getElementById('brushRemoveMode'),
            colorToRemove: document.getElementById('colorToRemove'),
            tolerance: document.getElementById('tolerance'),
            applyColorRemove: document.getElementById('applyColorRemove'),
            brushSize: document.getElementById('brushSize'),
            toleranceValue: document.getElementById('toleranceValue'),
            brushSizeValue: document.getElementById('brushSizeValue'),
            colorPickerSection: document.getElementById('colorPickerSection'),
            brushSection: document.getElementById('brushSection'),

            // Quality buttons
            qualityButtons: document.querySelectorAll('[data-quality]'),

            // Text tool
            textModal: document.getElementById('textModal'),
            textModalClose: document.getElementById('textModalClose'),
            textInput: document.getElementById('textInput'),
            textColor: document.getElementById('textColor'),
            textSize: document.getElementById('textSize'),
            textSizeValue: document.getElementById('textSizeValue'),
            previewText: document.getElementById('previewText'),
            cancelTextBtn: document.getElementById('cancelTextBtn'),
            applyTextBtn: document.getElementById('applyTextBtn'),
            addTextBtn: document.getElementById('addTextBtn')
        };

        // SHOW TOAST
        function showToast(message, isError = false, isWarning = false) {
            const toast = document.createElement('div');
            toast.className = `toast ${isError ? 'error' : isWarning ? 'warning' : ''}`;
            toast.textContent = message;
            document.body.appendChild(toast);
            setTimeout(() => toast.remove(), 3000);
        }

        // FILE UPLOAD
        elements.fileInput.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = (event) => {
                const img = new Image();
                img.onload = () => {
                    state.originalImage = img;
                    const maxWidth = window.innerWidth * 0.7;
                    const maxHeight = window.innerHeight * 0.8;
                    
                    let width = img.width;
                    let height = img.height;
                    
                    if (width > maxWidth) {
                        height = (height * maxWidth) / width;
                        width = maxWidth;
                    }
                    if (height > maxHeight) {
                        width = (width * maxHeight) / height;
                        height = maxHeight;
                    }

                    state.canvas.width = width;
                    state.canvas.height = height;
                    
                    elements.fileName.textContent = file.name;
                    elements.canvas.classList.remove('hidden');
                    elements.emptyState.classList.add('hidden');
                    elements.downloadBtn.disabled = false;
                    elements.resetBtn.disabled = false;

                    // Reset adjustments
                    resetAdjustments();
                    
                    redrawCanvas();
                    showToast('‚úì ≈û…ôkil uƒüurla y√ºkl…ôndi');
                };
                img.src = event.target.result;
            };
            reader.onerror = () => {
                showToast('‚úó ≈û…ôkil y√ºkl…ôn…ôrk…ôn x…ôta ba≈ü verdi', true);
            };
            reader.readAsDataURL(file);
        });

        // DRAG AND DROP
        elements.uploadZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            elements.uploadZone.classList.add('active');
        });

        elements.uploadZone.addEventListener('dragleave', () => {
            elements.uploadZone.classList.remove('active');
        });

        elements.uploadZone.addEventListener('drop', (e) => {
            e.preventDefault();
            elements.uploadZone.classList.remove('active');
            const file = e.dataTransfer.files[0];
            if (file && file.type.startsWith('image/')) {
                elements.fileInput.files = e.dataTransfer.files;
                elements.fileInput.dispatchEvent(new Event('change'));
            } else {
                showToast('‚úó Yalnƒ±z ≈ü…ôkil fayllarƒ± q…ôbul edilir', true);
            }
        });

        // RESET ADJUSTMENTS
        function resetAdjustments() {
            state.adjustments = {
                brightness: 0,
                contrast: 0,
                saturation: 0,
                hue: 0,
                blur: 0
            };
            
            state.currentFilter = 'none';
            
            // Reset sliders
            elements.brightness.value = 0;
            elements.contrast.value = 0;
            elements.saturation.value = 0;
            elements.hue.value = 0;
            elements.blur.value = 0;
            
            // Reset slider displays
            elements.brightnessValue.textContent = '0';
            elements.contrastValue.textContent = '0';
            elements.saturationValue.textContent = '0';
            elements.hueValue.textContent = '0';
            elements.blurValue.textContent = '0';
            
            // Reset filter buttons
            elements.filterButtons.forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.filter === 'none') {
                    btn.classList.add('active');
                }
            });
            
            // Reset text elements
            state.textElements = [];
            state.activeTextElement = null;
            
            redrawCanvas();
        }

        // REDRAW CANVAS
        function redrawCanvas() {
            if (!state.originalImage) return;

            state.ctx.clearRect(0, 0, state.canvas.width, state.canvas.height);

            // Apply filter
            applyFilter();

            // Draw image
            state.ctx.drawImage(state.originalImage, 0, 0, state.canvas.width, state.canvas.height);

            // Draw text elements
            drawTextElements();

            // Add watermark
            state.ctx.font = 'bold 12px -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif';
            state.ctx.fillStyle = 'rgba(241, 245, 249, 0.4)';
            state.ctx.textAlign = 'right';
            state.ctx.fillText('AxtarGet', state.canvas.width - 10, state.canvas.height - 10);
        }

        // APPLY FILTER
        function applyFilter() {
            let filterString = '';

            // Apply filter preset
            const filters = {
                none: '',
                grayscale: 'grayscale(100%)',
                sepia: 'sepia(60%)',
                vintage: 'sepia(50%) saturate(80%) brightness(1.1)',
                warm: 'sepia(30%) saturate(120%) brightness(1.1)',
                cool: 'hue-rotate(180deg) saturate(120%)',
                vibrant: 'saturate(150%) contrast(1.2)',
                dramatic: 'contrast(130%) saturate(80%) brightness(0.95)'
            };

            filterString += filters[state.currentFilter] || '';

            // Apply adjustments
            const brightness = 1 + state.adjustments.brightness / 100;
            const contrast = 1 + state.adjustments.contrast / 100;
            const saturation = 1 + state.adjustments.saturation / 100;
            const hue = state.adjustments.hue;

            filterString += ` brightness(${brightness}) contrast(${contrast}) saturate(${saturation}) hue-rotate(${hue}deg) blur(${state.adjustments.blur}px)`;

            state.ctx.filter = filterString;
        }

        // DRAW TEXT ELEMENTS
        function drawTextElements() {
            state.textElements.forEach(text => {
                state.ctx.font = `${text.size}px -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif`;
                state.ctx.fillStyle = text.color;
                state.ctx.textAlign = 'left';
                state.ctx.textBaseline = 'top';
                
                // Draw text
                state.ctx.fillText(text.content, text.x, text.y);
                
                // Draw selection border if active
                if (text === state.activeTextElement) {
                    const textMetrics = state.ctx.measureText(text.content);
                    const textWidth = textMetrics.width;
                    const textHeight = parseInt(text.size);
                    
                    state.ctx.strokeStyle = '#3B82F6';
                    state.ctx.lineWidth = 2;
                    state.ctx.strokeRect(text.x - 5, text.y - 5, textWidth + 10, textHeight + 10);
                    
                    // Draw resize handle
                    state.ctx.fillStyle = '#3B82F6';
                    state.ctx.fillRect(text.x + textWidth - 5, text.y + textHeight - 5, 10, 10);
                }
            });
        }

        // TOOL SELECTION
        function setActiveTool(tool) {
            // Remove active class from all tools
            document.querySelectorAll('.tool-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Add active class to selected tool
            document.getElementById(`tool${tool.charAt(0).toUpperCase() + tool.slice(1)}`).classList.add('active');
            
            state.currentTool = tool;
            
            // Update cursor
            switch(tool) {
                case 'select':
                    state.canvas.style.cursor = 'default';
                    break;
                case 'brush':
                    state.canvas.style.cursor = 'crosshair';
                    break;
                case 'text':
                    state.canvas.style.cursor = 'text';
                    break;
                default:
                    state.canvas.style.cursor = 'default';
            }
            
            // Show/hide appropriate panels
            elements.filtersSection.classList.add('hidden');
            elements.adjustmentsSection.classList.add('hidden');
            elements.bgRemovalSection.classList.add('hidden');
            elements.textSection.classList.add('hidden');
            
            switch(tool) {
                case 'filters':
                    elements.filtersSection.classList.remove('hidden');
                    break;
                case 'adjust':
                    elements.adjustmentsSection.classList.remove('hidden');
                    break;
                case 'remove':
                    elements.bgRemovalSection.classList.remove('hidden');
                    break;
                case 'text':
                    elements.textSection.classList.remove('hidden');
                    break;
            }
        }

        // FILTER BUTTONS
        elements.filterButtons.forEach(btn => {
            btn.addEventListener('click', () => {
                // Remove active class from all filter buttons
                elements.filterButtons.forEach(b => b.classList.remove('active'));
                
                // Add active class to clicked button
                btn.classList.add('active');
                
                // Update filter
                state.currentFilter = btn.dataset.filter;
                redrawCanvas();
            });
        });

        // ADJUSTMENT SLIDERS
        function setupSlider(slider, valueDisplay, property) {
            slider.addEventListener('input', () => {
                state.adjustments[property] = parseInt(slider.value);
                valueDisplay.textContent = slider.value;
                redrawCanvas();
            });
        }

        setupSlider(elements.brightness, elements.brightnessValue, 'brightness');
        setupSlider(elements.contrast, elements.contrastValue, 'contrast');
        setupSlider(elements.saturation, elements.saturationValue, 'saturation');
        setupSlider(elements.hue, elements.hueValue, 'hue');
        setupSlider(elements.blur, elements.blurValue, 'blur');

        // BACKGROUND REMOVAL MODE
        elements.colorRemoveMode.addEventListener('click', () => {
            elements.colorRemoveMode.classList.add('active');
            elements.brushRemoveMode.classList.remove('active');
            elements.colorPickerSection.classList.remove('hidden');
            elements.brushSection.classList.add('hidden');
            state.bgRemovalMode = 'color';
            state.canvas.style.cursor = 'default';
        });

        elements.brushRemoveMode.addEventListener('click', () => {
            elements.brushRemoveMode.classList.add('active');
            elements.colorRemoveMode.classList.remove('active');
            elements.colorPickerSection.classList.add('hidden');
            elements.brushSection.classList.remove('hidden');
            state.bgRemovalMode = 'brush';
            state.canvas.style.cursor = 'crosshair';
        });

        // BRUSH SIZE AND TOLERANCE SLIDERS
        elements.tolerance.addEventListener('input', () => {
            elements.toleranceValue.textContent = elements.tolerance.value;
        });

        elements.brushSize.addEventListener('input', () => {
            elements.brushSizeValue.textContent = elements.brushSize.value;
        });

        // APPLY COLOR REMOVAL
        elements.applyColorRemove.addEventListener('click', () => {
            if (!state.originalImage) {
                showToast('‚úó ∆èvv…ôlc…ô ≈ü…ôkil y√ºkl…ôyin', true);
                return;
            }

            const color = elements.colorToRemove.value;
            const tolerance = parseInt(elements.tolerance.value);
            
            // Convert hex to RGB
            const r = parseInt(color.substr(1, 2), 16);
            const g = parseInt(color.substr(3, 2), 16);
            const b = parseInt(color.substr(5, 2), 16);
            
            // Get image data
            const imageData = state.ctx.getImageData(0, 0, state.canvas.width, state.canvas.height);
            const data = imageData.data;
            
            // Remove background color
            for (let i = 0; i < data.length; i += 4) {
                const pixelR = data[i];
                const pixelG = data[i + 1];
                const pixelB = data[i + 2];
                
                // Calculate color distance
                const distance = Math.sqrt(
                    Math.pow(pixelR - r, 2) +
                    Math.pow(pixelG - g, 2) +
                    Math.pow(pixelB - b, 2)
                );
                
                // If color is within tolerance, make it transparent
                if (distance < tolerance) {
                    data[i + 3] = 0; // Set alpha to 0
                }
            }
            
            // Put image data back
            state.ctx.putImageData(imageData, 0, 0);
            showToast('‚úì Fon uƒüurla silindi');
        });

        // TEXT TOOL
        elements.toolText.addEventListener('click', () => {
            setActiveTool('text');
        });

        elements.addTextBtn.addEventListener('click', () => {
            elements.textModal.classList.remove('hidden');
        });

        elements.textModalClose.addEventListener('click', () => {
            elements.textModal.classList.add('hidden');
        });

        elements.cancelTextBtn.addEventListener('click', () => {
            elements.textModal.classList.add('hidden');
        });

        elements.textInput.addEventListener('input', () => {
            elements.previewText.textContent = elements.textInput.value || 'M…ôtn √ñnizl…ôm…ô';
        });

        elements.textColor.addEventListener('input', () => {
            elements.previewText.style.color = elements.textColor.value;
        });

        elements.textSize.addEventListener('input', () => {
            const size = elements.textSize.value;
            elements.textSizeValue.textContent = `${size}px`;
            elements.previewText.style.fontSize = `${size}px`;
        });

        elements.applyTextBtn.addEventListener('click', () => {
            const text = elements.textInput.value.trim();
            if (!text) {
                showToast('‚úó M…ôtn daxil edin', true);
                return;
            }

            const textElement = {
                content: text,
                color: elements.textColor.value,
                size: parseInt(elements.textSize.value),
                x: state.canvas.width / 2 - 50,
                y: state.canvas.height / 2 - 20
            };

            state.textElements.push(textElement);
            state.activeTextElement = textElement;
            
            elements.textModal.classList.add('hidden');
            redrawCanvas();
            showToast('‚úì M…ôtn uƒüurla …ôlav…ô edildi');
        });

        // CANVAS CLICK FOR TEXT SELECTION
        state.canvas.addEventListener('mousedown', (e) => {
            if (state.currentTool !== 'text' || !state.textElements.length) return;
            
            const rect = state.canvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            
            // Check if clicked on a text element
            for (let i = state.textElements.length - 1; i >= 0; i--) {
                const text = state.textElements[i];
                state.ctx.font = `${text.size}px -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif`;
                const textMetrics = state.ctx.measureText(text.content);
                const textWidth = textMetrics.width;
                const textHeight = parseInt(text.size);
                
                if (x >= text.x - 5 && x <= text.x + textWidth + 5 && 
                    y >= text.y - 5 && y <= text.y + textHeight + 5) {
                    
                    state.activeTextElement = text;
                    state.isDraggingText = true;
                    state.dragOffset.x = x - text.x;
                    state.dragOffset.y = y - text.y;
                    redrawCanvas();
                    return;
                }
            }
            
            // If clicked outside any text, deselect
            state.activeTextElement = null;
            redrawCanvas();
        });

        state.canvas.addEventListener('mousemove', (e) => {
            if (state.currentTool !== 'text' || !state.isDraggingText || !state.activeTextElement) return;
            
            const rect = state.canvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            
            state.activeTextElement.x = x - state.dragOffset.x;
            state.activeTextElement.y = y - state.dragOffset.y;
            
            redrawCanvas();
        });

        state.canvas.addEventListener('mouseup', () => {
            state.isDraggingText = false;
        });

        // QUALITY SETTINGS
        elements.qualityButtons.forEach(btn => {
            btn.addEventListener('click', () => {
                elements.qualityButtons.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                state.quality = parseFloat(btn.dataset.quality);
            });
        });

        // RESET BUTTON
        elements.resetBtn.addEventListener('click', () => {
            if (!state.originalImage) return;
            
            resetAdjustments();
            showToast('‚úì B√ºt√ºn d…ôyi≈üiklikl…ôr sƒ±fƒ±rlandƒ±');
        });

        // DOWNLOAD BUTTON
        elements.downloadBtn.addEventListener('click', () => {
            if (!state.originalImage) {
                showToast('‚úó Endirm…ôk √º√ß√ºn ≈ü…ôkil yoxdur', true);
                return;
            }

            // Create temporary canvas for download
            const tempCanvas = document.createElement('canvas');
            tempCanvas.width = state.canvas.width;
            tempCanvas.height = state.canvas.height;
            const tempCtx = tempCanvas.getContext('2d');
            
            // Apply current filters and adjustments
            tempCtx.filter = state.ctx.filter;
            tempCtx.drawImage(state.originalImage, 0, 0, tempCanvas.width, tempCanvas.height);
            
            // Draw text elements without watermark
            state.textElements.forEach(text => {
                tempCtx.font = `${text.size}px -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif`;
                tempCtx.fillStyle = text.color;
                tempCtx.textAlign = 'left';
                tempCtx.textBaseline = 'top';
                tempCtx.fillText(text.content, text.x, text.y);
            });
            
            // Create download link
            const link = document.createElement('a');
            link.download = `edited-${elements.fileName.textContent || 'image'}.jpg`;
            link.href = tempCanvas.toDataURL('image/jpeg', state.quality);
            link.click();
            
            showToast('‚úì ≈û…ôkil uƒüurla endirildi');
        });

        // TOOL BUTTON CLICKS
        elements.toolSelect.addEventListener('click', () => setActiveTool('select'));
        elements.toolFilters.addEventListener('click', () => setActiveTool('filters'));
        elements.toolAdjust.addEventListener('click', () => setActiveTool('adjust'));
        elements.toolRemove.addEventListener('click', () => setActiveTool('remove'));
        elements.toolBrush.addEventListener('click', () => setActiveTool('brush'));
        elements.toolText.addEventListener('click', () => setActiveTool('text'));

        // INITIALIZE
        function init() {
            // Set initial tool
            setActiveTool('select');
            
            // Set initial slider values
            elements.brightnessValue.textContent = elements.brightness.value;
            elements.contrastValue.textContent = elements.contrast.value;
            elements.saturationValue.textContent = elements.saturation.value;
            elements.hueValue.textContent = elements.hue.value;
            elements.blurValue.textContent = elements.blur.value;
            elements.toleranceValue.textContent = elements.tolerance.value;
            elements.brushSizeValue.textContent = elements.brushSize.value;
            elements.textSizeValue.textContent = `${elements.textSize.value}px`;
            
            showToast('AxtarGet ≈û…ôkil Redaktoruna xo≈ü g…ôlmisiniz!', false, true);
        }

        // Start the application
        init();
    </script>
</body>
</html>
